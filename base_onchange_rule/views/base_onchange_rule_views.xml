<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <record id="base_onchange_rule_search_view" model="ir.ui.view">
        <field name="name">base.onchange.rule.search</field>
        <field name="model">base.onchange.rule</field>
        <field name="arch" type="xml">
            <search string="Onchage Rule">
                <field name="name" />
                <field name="model" />
                <field name="onchange_fields" />
                <group expand="0" string="Group By...">
                    <filter
                        string="Model"
                        name="model"
                        context="{'group_by': 'model'}"
                    />
                </group>
            </search>
        </field>
    </record>
    <record id="base_onchange_rule_tree_view" model="ir.ui.view">
        <field name="name">base.onchange.rule.tree</field>
        <field name="model">base.onchange.rule</field>
        <field name="arch" type="xml">
            <tree string="Onchange Rules">
                <field name="sequence" widget="handle" />
                <field name="name" />
                <field name="description" />
                <field name="onchange_fields" />
                <field name="active" widget="boolean_toggle" />
            </tree>
        </field>
    </record>
    <record id="base_onchange_rule_form_view" model="ir.ui.view">
        <field name="name">base.onchange.rule.form</field>
        <field name="model">base.onchange.rule</field>
        <field name="arch" type="xml">
            <form string="Onchange Rules">
                <sheet>
                    <field name="active" invisible="1" />
                    <widget
                        name="web_ribbon"
                        text="Archived"
                        bg_color="bg-danger"
                        attrs="{'invisible': [('active', '=', True)]}"
                    />
                    <h1>
                        <field name="name" />
                    </h1>
                    <group name="main">
                        <field name="model_name" invisible="1" />
                        <field
                            name="model"
                            options="{'no_create_edit': True}"
                            attrs="{'readonly': ['|', ('onchange_fields', '!=', []), ('fields_lines', '!=', [])]}"
                        />
                        <field
                            name="onchange_fields"
                            widget="many2many_tags"
                            options="{'no_create_edit': True}"
                        />
                        <field
                            name="company_id"
                            options='{"no_open": True, "no_create": True}'
                        />
                    </group>
                    <notebook>
                        <page string="Condition" name="python_code">
                            <field
                                name="code"
                                widget="ace"
                                options="{'mode': 'python'}"
                            />
                        </page>
                        <page string="Data to Write" name="page_object">
                            <field
                                name="fields_lines"
                                context="{'default_onchange_rule_model_name': model_name}"
                            >
                                <tree string="Field Mappings" editable="bottom">
                                    <field
                                        name="onchange_rule_model_name"
                                        invisible="1"
                                    />
                                    <field
                                        name="col1"
                                        domain="[('model_id', '=', onchange_rule_model_name)]"
                                    />
                                    <field name="evaluation_type" />
                                    <field
                                        name="resource_ref"
                                        attrs="{'readonly': [('evaluation_type', '!=', 'reference')]}"
                                        options="{'hide_model': True}"
                                    />
                                    <field
                                        name="value"
                                        attrs="{'readonly': [('evaluation_type', '=', 'reference')]}"
                                        force_save="1"
                                    />
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>
    <record id="base_onchange_rule_action" model="ir.actions.act_window">
        <field name="name">Onchange Rules</field>
        <field name="res_model">base.onchange.rule</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{'active_test': False}</field>
    </record>
    <!-- Menu Items -->
    <menuitem
        id="menu_base_onchange_rule"
        name="Onchange Rules"
        action="base_onchange_rule_action"
        parent="base.menu_custom"
        sequence="40"
    />
</odoo>
