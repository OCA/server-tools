===========================
IP level access restriction
===========================

.. !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! This file is generated by oca-gen-addon-readme !!
   !! changes will be overwritten.                   !!
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

.. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
    :target: https://odoo-community.org/page/development-status
    :alt: Beta
.. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
    :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
    :alt: License: AGPL-3
.. |badge3| image:: https://img.shields.io/badge/github-OCA%2Fserver--tools-lightgray.png?logo=github
    :target: https://github.com/OCA/server-tools/tree/10.0/auth_ip_access
    :alt: OCA/server-tools
.. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
    :target: https://translation.odoo-community.org/projects/server-tools-10-0/server-tools-10-0-auth_ip_access
    :alt: Translate me on Weblate
.. |badge5| image:: https://img.shields.io/badge/runbot-Try%20me-875A7B.png
    :target: https://runbot.odoo-community.org/runbot/149/10.0
    :alt: Try me on Runbot

|badge1| |badge2| |badge3| |badge4| |badge5| 

This module allows you to restrict who is allowed to login to Odoo based on
the remote IP address. The restriction is applied upon login, and on RPC
calls. Note: valid web sessions are not impacted, and access to the public
website can not be restricted using this module.

When a login is rejected because of a missing IP access rule, a warning is
logged in the application log but no specific information is provided to the
user that is trying to log on. Instead, a generic access denied error is
generated (which is rendered in the web client as 'Wrong login/password'.

**Table of contents**

.. contents::
   :local:

Installation
============

Please make the python library py2-ipaddress available in the environment in which you run Odoo before installing this module.

Configuration
=============

Go to menu *Settings -> Technical -> Security -> IP Access Rules* to create
access rules for the group whose access you want to limit. If no rules exist
for the groups of a user, it is not restricted to login from anywhere.

Each rule allows you to allow access for a specific group, or user, from IP
address or an IP network (using a netmask, e.g. 192.168.0.1/24).

Rules can be configured for a group, or for a user but not for both at the
same time. If neither group or user is configured, the rule is applied
globally.

A special case is where you allow logins from *any* private network (e.g.
networks in the 192.168.x.x or the 10.x.x.x ranges). You can create such a
rule by ticking the *private* checkbox on the rule.

If you accidentally lock yourself out you can regain access by accessing
your Odoo database through SQL and execute the following command.

.. code-block:: SQL

   UPDATE ip_access_rule SET active = FALSE;

You will need to restart Odoo to clear the IP access cache. This will lift all IP access restrictions.

Note: if you run Odoo behind a proxy (and you should, because where do you get your
SSL encryption from?), you need to set *proxy_mode = True* in the Odoo
configuration file to ensure that the remote address is properly propaged to
Odoo and is not set to the IP address of the proxy server. A setup like this
is dependent on the proxy server setting the correct remote address in the
*X-Forwarded-For* header.

Bug Tracker
===========

Bugs are tracked on `GitHub Issues <https://github.com/OCA/server-tools/issues>`_.
In case of trouble, please check there if your issue has already been reported.
If you spotted it first, help us smashing it by providing a detailed and welcomed
`feedback <https://github.com/OCA/server-tools/issues/new?body=module:%20auth_ip_access%0Aversion:%2010.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.

Do not contact contributors directly about support or help with technical issues.

Credits
=======

Authors
~~~~~~~

* Opener B.V.

Contributors
~~~~~~~~~~~~

* Stefan Rijnhart <stefan@opener.amsterdam>

Other credits
~~~~~~~~~~~~~

* Some technical guidance was aquired from the module 'auth_brute_force' in
  this repository. A big thanks to the author of that module, Sylvan Le Gal
  and its subsequent contributors, especially Jairo Llopis for his work on
  making the remote address available at all times.
* The heavy lifting of this module is done by https://pypi.org/project/py2-ipaddress/.

Maintainers
~~~~~~~~~~~

This module is maintained by the OCA.

.. image:: https://odoo-community.org/logo.png
   :alt: Odoo Community Association
   :target: https://odoo-community.org

OCA, or the Odoo Community Association, is a nonprofit organization whose
mission is to support the collaborative development of Odoo features and
promote its widespread use.

This module is part of the `OCA/server-tools <https://github.com/OCA/server-tools/tree/10.0/auth_ip_access>`_ project on GitHub.

You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
